<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
 xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
 layout:decorate="~{layout/layout}">
<head>
<!-- JS読込 -->
<script th:src="@{/js/mypage.js}" defer></script>
</head>
<body>
<div layout:fragment="content">
	<!--プロフィール-->
	<div class="row profile">
		<div class="col-md-2">
			<div class="row">
				<!--画像-->
				<div class="col-md-12 d-flex justify-content-center">
					<div class ="img-container m-2">
						<img th:src="${profile.filePath != null && !profile.filePath.trim().isEmpty()} ? @{${uploadDirProfilet} + ${profile.filePath}} : '/images/profileImage.png'" alt="ProfileImage">
					</div>
				</div>
				<!--ニックネーム-->
				<div class="col-md-12 d-flex justify-content-center">
					<p th:text="${profile.getNickname}"></p>
				</div>
			</div>
		</div>
		
		<div class="col-md-2">
			<!--植物数-->
			<div class="row">
				<div class="col-12 d-flex justify-content-center">
					<p th:text="#{plantCount}"></p>
				</div>
				<div class="col-12 d-flex justify-content-center">
					<p th:text="${plantCount}"></p>
				</div>
			</div>
			<!--観察日記数-->
			<div class="row">
				<div class="col-12 d-flex justify-content-center">
					<p th:text="#{diaryCount}"></p>
				</div>
				<div class="col-12 d-flex justify-content-center">
					<p th:text="${diaryCount}"></p>
				</div>
			</div>
		</div>
		
		<div class="col-md-8">
			<p th:text="${profile.profile}"></p>
		</div>
		
	</div>
	
	<!--追加ボタン＆検索-->
	<div class="row my-2 d-flex justify-content-between">
		<!-- 植物追加ボタン -->
		<div class="col-md-1  d-flex align-items-center">
			<a class="icon-container" th:href="@{/plant/add}">
				<img src="/images/plusicon.png" alt="#{plusIcon}" class="img-fluid" />
			</a>
		</div>
		<!-- 検索 -->
		<div class ="col-md-4">
			<form class="d-flex" role="search">
		        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
		        <button class="btn btn-outline-success" type="submit">Search</button>
      		</form>
		</div>
	</div>
	
	<!--植物一覧-->
	<div class="row my-2">
		<div class="col-md-3 mb-4 col-plant" th:each="plant : ${plantList}">
			<div class="card">
				<!-- 削除ボタン(削除確認モーダル表示) -->
				<img class="delete-plant" th:onclick="'showDeleteModal(' + ${plant.id} + ')'" alt="deleteplant" src="/images/deleteicon.png">
				<!-- 削除処理 -->
				<form th:id="'deleteForm' + ${plant.id}" th:action="@{/plant/delete/{id}(id=${plant.id})}" method="post" style="display:none;">
                	<input type="hidden" name="_method" value="delete"/>
            	</form>
				<!-- 植物画像 -->
				<img class="card-img-top" alt="plantImage"
					th:class="${plant.filePath != null && !plant.filePath.trim().isEmpty()} ? '' : 'img-70'"
					th:src="${plant.filePath != null && !plant.filePath.trim().isEmpty()} ? @{${uploadDirPlant} + ${plant.filePath}} : '/images/plantImage.png'">
                <!-- 植物名前 -->
                <div class="card-body">
                    <h5 class="card-title" th:text="${plant.name}"></h5>
                </div>
			</div>
		</div>
	</div>

	<!-- モーダル -->
	<div class="modal" tabindex="-1" id="deleteModal">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title">削除確認</h5>
	        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
	      </div>
	      <div class="modal-body">
	        <p>本当に削除しますか？</p>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
	        <button type="button" class="btn btn-primary" id="confirmDeleteButton">削除</button>
	      </div>
	    </div>
	  </div>
	</div>

</div>
</body>
</html>